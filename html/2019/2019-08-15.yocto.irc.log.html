<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Thursday, 2019-08-15</title>
  <link rel="stylesheet" href="irclog.css" />
  <meta name="generator" content="irclog2html.py 2.11.0 by Marius Gedminas" />
  <meta name="version" content="2.11.0 - 2012-07-30" />
</head>
<body>
<h1>Thursday, 2019-08-15</h1>
<div class="navigation"> <a href="%23yocto.2019-08-14.log.html">&#171; Wednesday, 2019-08-14</a> <a href="index.html">Index</a> <a href="%23yocto.2019-08-16.log.html">Friday, 2019-08-16 &#187;</a> </div>
<table class="irclog">
<tr id="t2019-08-15T06:16:09"><td class="part" colspan="2">*** jeanba &lt;jeanba!~jbl@77.243.63.34&gt; has left #yocto</td><td><a href="#t2019-08-15T06:16:09" class="time">06:16</a></td></tr>
<tr id="t2019-08-15T06:26:34"><td class="nickchange" colspan="2">*** chinhuat69 is now known as chinhuat</td><td><a href="#t2019-08-15T06:26:34" class="time">06:26</a></td></tr>
<tr id="t2019-08-15T08:24:38"><th class="nick" style="background: #407a40">qt-x</th><td class="text" style="color: #407a40">Can a recipe be made to build multile images ? eg. bitbake multi-image</td><td class="time"><a href="#t2019-08-15T08:24:38" class="time">08:24</a></td></tr>
<tr id="t2019-08-15T08:26:00"><th class="nick" style="background: #407a40">qt-x</th><td class="text" style="color: #407a40">where multi-image.bb instructs to build 3 or more images</td><td class="time"><a href="#t2019-08-15T08:26:00" class="time">08:26</a></td></tr>
<tr id="t2019-08-15T08:28:46"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">qt-x: yes, just have them as dependencies do_sometask[depends] = "image1:do_image_complete image2:do_image_complete2 imag3_do_image_complete"</td><td class="time"><a href="#t2019-08-15T08:28:46" class="time">08:28</a></td></tr>
<tr id="t2019-08-15T08:30:13"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">RP: Regarding that ResourceWarning I mentioned yesterday, I am building without the hash server enabled.</td><td class="time"><a href="#t2019-08-15T08:30:13" class="time">08:30</a></td></tr>
<tr id="t2019-08-15T08:30:14"><th class="nick" style="background: #407a40">qt-x</th><td class="text" style="color: #407a40">awesome thanks RP</td><td class="time"><a href="#t2019-08-15T08:30:14" class="time">08:30</a></td></tr>
<tr id="t2019-08-15T08:37:47"><td class="part" colspan="2">*** jeanba &lt;jeanba!~jbl@77.243.63.34&gt; has left #yocto</td><td><a href="#t2019-08-15T08:37:47" class="time">08:37</a></td></tr>
<tr id="t2019-08-15T08:49:44"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">Hi everyone</td><td class="time"><a href="#t2019-08-15T08:49:44" class="time">08:49</a></td></tr>
<tr id="t2019-08-15T08:50:24"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">I was wondering why when an initramfs is built and bundled with bitbake, the kernel with the bundled initramfs is not actually packages</td><td class="time"><a href="#t2019-08-15T08:50:24" class="time">08:50</a></td></tr>
<tr id="t2019-08-15T08:50:35"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">and only left laying around in the build tree</td><td class="time"><a href="#t2019-08-15T08:50:35" class="time">08:50</a></td></tr>
<tr id="t2019-08-15T08:52:36"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">s/packages/packaged/</td><td class="time"><a href="#t2019-08-15T08:52:36" class="time">08:52</a></td></tr>
<tr id="t2019-08-15T08:56:05"><th class="nick" style="background: #488888">yocti</th><td class="text" style="color: #488888">New news from stackoverflow: /dev/fd/ socket or pipe links fail, NOT missing /dev/fd link &lt;<a href="https://stackoverflow.com/questions/57498881/dev-fd-socket-or-pipe-links-fail-not-missing-dev-fd-link&gt;" rel="nofollow">https://stackoverflow.com/questions/57498881/dev-fd-socket-or-pipe-links-fail-not-missing-dev-fd-link&gt;</a></td><td class="time"><a href="#t2019-08-15T08:56:05" class="time">08:56</a></td></tr>
<tr id="t2019-08-15T09:11:47"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">In my case Image.gz.initramfs is created but only Image.gz is packaged</td><td class="time"><a href="#t2019-08-15T09:11:47" class="time">09:11</a></td></tr>
<tr id="t2019-08-15T09:12:23"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">This is inside kernel.bbclass</td><td class="time"><a href="#t2019-08-15T09:12:23" class="time">09:12</a></td></tr>
<tr id="t2019-08-15T11:25:15"><th class="nick" style="background: #8c4a4a">ndec</th><td class="text" style="color: #8c4a4a">LetoThe2nd: <a href="https://www.youtube.com/watch?v=Itn_at7kfVw" rel="nofollow">https://www.youtube.com/watch?v=Itn_at7kfVw</a></td><td class="time"><a href="#t2019-08-15T11:25:15" class="time">11:25</a></td></tr>
<tr id="t2019-08-15T11:33:38"><th class="nick" style="background: #4b904b">Crofton|work</th><td class="text" style="color: #4b904b">scary thig to see in the morning!</td><td class="time"><a href="#t2019-08-15T11:33:38" class="time">11:33</a></td></tr>
<tr id="t2019-08-15T12:28:43"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">Does anyone have any input regarding the question I asked earlier?</td><td class="time"><a href="#t2019-08-15T12:28:43" class="time">12:28</a></td></tr>
<tr id="t2019-08-15T12:29:38"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">asabil: initramfs depends on a lot of different things, some images include them, some don't. It could also vary depending on the target architecture, kernel and machine. Basically it depends on a lot of different things</td><td class="time"><a href="#t2019-08-15T12:29:38" class="time">12:29</a></td></tr>
<tr id="t2019-08-15T12:30:05"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">RP: yes I know, my problem is with the kernel.bbclass</td><td class="time"><a href="#t2019-08-15T12:30:05" class="time">12:30</a></td></tr>
<tr id="t2019-08-15T12:30:32"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">it generates &lt;Image&gt;.initramfs and then forgets about it</td><td class="time"><a href="#t2019-08-15T12:30:32" class="time">12:30</a></td></tr>
<tr id="t2019-08-15T12:30:54"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">it feels like a bug to me, but I am not sure</td><td class="time"><a href="#t2019-08-15T12:30:54" class="time">12:30</a></td></tr>
<tr id="t2019-08-15T12:31:14"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685"><a href="https://git.yoctoproject.org/cgit/cgit.cgi/poky/tree/meta/classes/kernel.bbclass#n256" rel="nofollow">https://git.yoctoproject.org/cgit/cgit.cgi/poky/tree/meta/classes/kernel.bbclass#n256</a></td><td class="time"><a href="#t2019-08-15T12:31:14" class="time">12:31</a></td></tr>
<tr id="t2019-08-15T12:32:05"><th class="nick" style="background: #4d4d93">Dvorkin</th><td class="text" style="color: #4d4d93">How to overwrite default Kconfig vaue using meta?</td><td class="time"><a href="#t2019-08-15T12:32:05" class="time">12:32</a></td></tr>
<tr id="t2019-08-15T12:32:39"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">hello</td><td class="time"><a href="#t2019-08-15T12:32:39" class="time">12:32</a></td></tr>
<tr id="t2019-08-15T12:32:54"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">I have vendor SDK which have heavy patched u-boot + kernel + rootfs</td><td class="time"><a href="#t2019-08-15T12:32:54" class="time">12:32</a></td></tr>
<tr id="t2019-08-15T12:33:04"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">and then this is where it specifies the Package files <a href="https://git.yoctoproject.org/cgit/cgit.cgi/poky/tree/meta/classes/kernel.bbclass#n93" rel="nofollow">https://git.yoctoproject.org/cgit/cgit.cgi/poky/tree/meta/classes/kernel.bbclass#n93</a></td><td class="time"><a href="#t2019-08-15T12:33:04" class="time">12:33</a></td></tr>
<tr id="t2019-08-15T12:33:07"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">I plan to use u-boot and kernel and move building rest to yocto</td><td class="time"><a href="#t2019-08-15T12:33:07" class="time">12:33</a></td></tr>
<tr id="t2019-08-15T12:33:14"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">project using 4.9. linaro toolchain</td><td class="time"><a href="#t2019-08-15T12:33:14" class="time">12:33</a></td></tr>
<tr id="t2019-08-15T12:33:25"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">my target is poky rocko</td><td class="time"><a href="#t2019-08-15T12:33:25" class="time">12:33</a></td></tr>
<tr id="t2019-08-15T12:33:33"><th class="nick" style="background: #854685">asabil</th><td class="text" style="color: #854685">nothing ever refers to $imageType.initramfs</td><td class="time"><a href="#t2019-08-15T12:33:33" class="time">12:33</a></td></tr>
<tr id="t2019-08-15T12:34:03"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">but I'm having some issues like: ERROR: gmp-6.1.2-r0 do_package_qa: QA Issue: libgmpxx rdepends on external-linaro-toolchain-dbg [debug-deps]</td><td class="time"><a href="#t2019-08-15T12:34:03" class="time">12:34</a></td></tr>
<tr id="t2019-08-15T12:34:03"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">ERROR: gmp-6.1.2-r0 do_package_qa: QA Issue: /usr/lib/libgmpxx.so.4.5.2 contained in package libgmpxx requires libstdc++.so.6(CXXABI_1.3), but no providers found in RDEPENDS_libgmpxx? [file-rdeps]</td><td class="time"><a href="#t2019-08-15T12:34:03" class="time">12:34</a></td></tr>
<tr id="t2019-08-15T12:34:03"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">ERROR: gmp-6.1.2-r0 do_package_qa: QA Issue: /usr/lib/libgmpxx.so.4.5.2 contained in package libgmpxx requires libstdc++.so.6(CXXABI_ARM_1.3.3), but no providers found in RDEPENDS_libgmpxx? [file-rdeps]</td><td class="time"><a href="#t2019-08-15T12:34:03" class="time">12:34</a></td></tr>
<tr id="t2019-08-15T12:34:03"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">ERROR: gmp-6.1.2-r0 do_package_qa: QA Issue: /usr/lib/libgmpxx.so.4.5.2 contained in package libgmpxx requires libstdc++.so.6(GLIBCXX_3.4), but no providers found in RDEPENDS_libgmpxx? [file-rdeps]</td><td class="time"><a href="#t2019-08-15T12:34:03" class="time">12:34</a></td></tr>
<tr id="t2019-08-15T12:34:06"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">ERROR: gmp-6.1.2-r0 do_package_qa: QA Issue: /usr/lib/libgmpxx.so.4.5.2 contained in package libgmpxx requires libstdc++.so.6(GLIBCXX_3.4.11), but no providers found in RDEPENDS_libgmpxx? [file-rdeps]</td><td class="time"><a href="#t2019-08-15T12:34:06" class="time">12:34</a></td></tr>
<tr id="t2019-08-15T12:34:09"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">ERROR: gmp-6.1.2-r0 do_package_qa: QA Issue: /usr/lib/libgmpxx.so.4.5.2 contained in package libgmpxx requires libstdc++.so.6, but no providers found in RDEPENDS_libgmpxx? [file-rdeps]</td><td class="time"><a href="#t2019-08-15T12:34:09" class="time">12:34</a></td></tr>
<tr id="t2019-08-15T12:34:18"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">it is even good idea to try it like that?</td><td class="time"><a href="#t2019-08-15T12:34:18" class="time">12:34</a></td></tr>
<tr id="t2019-08-15T12:38:37"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">opennandra: the shlibs automatic dependency code is confused as it can't figure out what should be providing libstdc++</td><td class="time"><a href="#t2019-08-15T12:38:37" class="time">12:38</a></td></tr>
<tr id="t2019-08-15T12:38:53"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">opennandra: a question for the supplier of this external toolchain</td><td class="time"><a href="#t2019-08-15T12:38:53" class="time">12:38</a></td></tr>
<tr id="t2019-08-15T12:39:06"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">RP: looks like it's QA issue so can I just suppress it and try?</td><td class="time"><a href="#t2019-08-15T12:39:06" class="time">12:39</a></td></tr>
<tr id="t2019-08-15T12:39:14"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">does this thing even make sense?</td><td class="time"><a href="#t2019-08-15T12:39:14" class="time">12:39</a></td></tr>
<tr id="t2019-08-15T12:46:59"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">RP:&nbsp;&nbsp;I have some more information about the glibc-locale pseudo issue, but I still don't really understand the nature of the problem yet.</td><td class="time"><a href="#t2019-08-15T12:46:59" class="time">12:46</a></td></tr>
<tr id="t2019-08-15T12:47:22"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It took 11 hours to get an instrumented pseudo to reproduce the problem.&nbsp;&nbsp;It just failed a bit ago.</td><td class="time"><a href="#t2019-08-15T12:47:22" class="time">12:47</a></td></tr>
<tr id="t2019-08-15T12:47:30"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b"><a href="https://pastebin.com/yHc0HSme" rel="nofollow">https://pastebin.com/yHc0HSme</a></td><td class="time"><a href="#t2019-08-15T12:47:30" class="time">12:47</a></td></tr>
<tr id="t2019-08-15T12:47:52"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I don't know how much you looked at it, but there is a filter log with the important bits stripped out.</td><td class="time"><a href="#t2019-08-15T12:47:52" class="time">12:47</a></td></tr>
<tr id="t2019-08-15T12:49:32"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I am trying to understand the sequence of events that lead up to pseudo to decide the uid is wrong.</td><td class="time"><a href="#t2019-08-15T12:49:32" class="time">12:49</a></td></tr>
<tr id="t2019-08-15T13:12:45"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">opennandra: Its a warning that something is seriously wrong with your build. Sure you can turn it off but that doesn't fix it.</td><td class="time"><a href="#t2019-08-15T13:12:45" class="time">13:12</a></td></tr>
<tr id="t2019-08-15T13:13:08"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: interesting. Let me see if I can page in from swap :)</td><td class="time"><a href="#t2019-08-15T13:13:08" class="time">13:13</a></td></tr>
<tr id="t2019-08-15T13:13:10"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">RP: ok what is then sugeested way ? Use some older yoct orelease?</td><td class="time"><a href="#t2019-08-15T13:13:10" class="time">13:13</a></td></tr>
<tr id="t2019-08-15T13:13:21"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">Rp: I need to build stuff with external toolchain</td><td class="time"><a href="#t2019-08-15T13:13:21" class="time">13:13</a></td></tr>
<tr id="t2019-08-15T13:17:46"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">opennandra: Fix the external toolchain, or as the supplier of the external toolchain why its broken. I know nothing about it so I can't really help. I know what that error means but I don't know what the correct fix is or anything about the toolchain. I do know that turning off the check will just make it fail later</td><td class="time"><a href="#t2019-08-15T13:17:46" class="time">13:17</a></td></tr>
<tr id="t2019-08-15T13:18:03"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: the other interesting thing is "mode 100600" - where did that come from...</td><td class="time"><a href="#t2019-08-15T13:18:03" class="time">13:18</a></td></tr>
<tr id="t2019-08-15T13:18:33"><th class="nick" style="background: #97974f">opennandra</th><td class="text" style="color: #97974f">RP: ok thanks a lot, I'll ask on mailing list then</td><td class="time"><a href="#t2019-08-15T13:18:33" class="time">13:18</a></td></tr>
<tr id="t2019-08-15T13:19:17"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I've always thought that there was stale data in pseudo's db that by chance happens to corrupt a new file</td><td class="time"><a href="#t2019-08-15T13:19:17" class="time">13:19</a></td></tr>
<tr id="t2019-08-15T13:19:37"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: If I was right about that, the question is where did the bad info come from (stale inode?)</td><td class="time"><a href="#t2019-08-15T13:19:37" class="time">13:19</a></td></tr>
<tr id="t2019-08-15T13:20:02"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: how complete are your logs? can you tell if that inode has any previous history with an unrelated file?</td><td class="time"><a href="#t2019-08-15T13:20:02" class="time">13:20</a></td></tr>
<tr id="t2019-08-15T13:22:10"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">RP: Is there some way to tell bitbake to copy files from SSTATE_MIRRORS rather than creating symbolic links to them? In our case we have the global sstate cache on an NFS mount and I would prefer to copy the files to the local sstate cache rather than having to retrieve them via NFS each time.</td><td class="time"><a href="#t2019-08-15T13:22:10" class="time">13:22</a></td></tr>
<tr id="t2019-08-15T13:31:16"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">Saur: you'd have to tweak the fetcher code afaik</td><td class="time"><a href="#t2019-08-15T13:31:16" class="time">13:31</a></td></tr>
<tr id="t2019-08-15T13:33:02"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">RP: Ok. Would it be acceptable to add a way to force copying instead of linking? Either globally, or perhaps some way to do it per URL in SSTATE_MIRRORS?</td><td class="time"><a href="#t2019-08-15T13:33:02" class="time">13:33</a></td></tr>
<tr id="t2019-08-15T13:33:44"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">Saur: My reservation is just about more codepaths combinations in the fetcher code :(</td><td class="time"><a href="#t2019-08-15T13:33:44" class="time">13:33</a></td></tr>
<tr id="t2019-08-15T13:34:05"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">per url in sstate_mirrors sounds like some kind of nightmare</td><td class="time"><a href="#t2019-08-15T13:34:05" class="time">13:34</a></td></tr>
<tr id="t2019-08-15T13:34:39"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">Probably not too easy to add either. Globally should probably be a lot easier.</td><td class="time"><a href="#t2019-08-15T13:34:39" class="time">13:34</a></td></tr>
<tr id="t2019-08-15T13:35:04"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">Ok, I'll have a look at the code and see what it would involve.</td><td class="time"><a href="#t2019-08-15T13:35:04" class="time">13:35</a></td></tr>
<tr id="t2019-08-15T13:36:34"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">Saur: The trouble is each time you add a binary "yes/no" decision for a feature like that into the fetcher, it doubles our test matric</td><td class="time"><a href="#t2019-08-15T13:36:34" class="time">13:36</a></td></tr>
<tr id="t2019-08-15T13:37:02"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">matirx. Given the people we have maintaining it (or not), I'm rather adverse to such controls</td><td class="time"><a href="#t2019-08-15T13:37:02" class="time">13:37</a></td></tr>
<tr id="t2019-08-15T13:38:43"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">RP: Yeah, I know. At the same time having the symbolic links to an NFS mount is less than optimal. Especially when there is network failure and the NFS mount is gone for a day due to IT not being able to get the network working (yes, we had that the other day) :P</td><td class="time"><a href="#t2019-08-15T13:38:43" class="time">13:38</a></td></tr>
<tr id="t2019-08-15T13:39:30"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Saur: You might be able to expose it over HTTP also?</td><td class="time"><a href="#t2019-08-15T13:39:30" class="time">13:39</a></td></tr>
<tr id="t2019-08-15T13:40:17"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">JPEW: Yeah, that is an alternative, but then it becomes a matter of authentication... With the NFS mount that is taken care of by who can mount it...</td><td class="time"><a href="#t2019-08-15T13:40:17" class="time">13:40</a></td></tr>
<tr id="t2019-08-15T13:40:37"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Saur: Ah, ya that gets a little tricky</td><td class="time"><a href="#t2019-08-15T13:40:37" class="time">13:40</a></td></tr>
<tr id="t2019-08-15T13:42:05"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: btw, I found another data corruption bug in runqueue. Hoping this explains a few weird things!</td><td class="time"><a href="#t2019-08-15T13:42:05" class="time">13:42</a></td></tr>
<tr id="t2019-08-15T13:42:36"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Cool. Did you get any stats from the AB?</td><td class="time"><a href="#t2019-08-15T13:42:36" class="time">13:42</a></td></tr>
<tr id="t2019-08-15T13:42:42"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">Saur: Its a tricky one. Once I accept such a patch we're stuck trying to maintain that API effectively indefinitely though :/</td><td class="time"><a href="#t2019-08-15T13:42:42" class="time">13:42</a></td></tr>
<tr id="t2019-08-15T13:43:05"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: {"connections": {"total_time": 2058.1817467394285, "max_time": 0.2676054770126939, "num": 1772291, "average": 0.0011613114024386676, "stdev": 0.003402929594519231}, "requests": {"total_time": 1224.0615269057453, "max_time": 0.26773543702438474, "num": 1772290, "average": 0.0006906666103773904, "stdev": 0.0005487492249695723}}</td><td class="time"><a href="#t2019-08-15T13:43:05" class="time">13:43</a></td></tr>
<tr id="t2019-08-15T13:43:17"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: that was after a single build approximately completed</td><td class="time"><a href="#t2019-08-15T13:43:17" class="time">13:43</a></td></tr>
<tr id="t2019-08-15T13:43:30"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Any connection timeouts?</td><td class="time"><a href="#t2019-08-15T13:43:30" class="time">13:43</a></td></tr>
<tr id="t2019-08-15T13:43:38"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: loads</td><td class="time"><a href="#t2019-08-15T13:43:38" class="time">13:43</a></td></tr>
<tr id="t2019-08-15T13:44:05"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: <a href="https://autobuilder.yoctoproject.org/typhoon/#/builders/83/builds/331" rel="nofollow">https://autobuilder.yoctoproject.org/typhoon/#/builders/83/builds/331</a> - any warning is a timeout</td><td class="time"><a href="#t2019-08-15T13:44:05" class="time">13:44</a></td></tr>
<tr id="t2019-08-15T13:44:24"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Hmm. Ok, that's unfortunate. It means my stats probably aren't capturing where the timeout happens :(</td><td class="time"><a href="#t2019-08-15T13:44:24" class="time">13:44</a></td></tr>
<tr id="t2019-08-15T13:44:32"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">RP: Yet without the possible to add those kinds of tweaks, my hands are very limited as I have no way of doing local modifications to bitbake, compared to classes and recipes that I can copy/append to locally.</td><td class="time"><a href="#t2019-08-15T13:44:32" class="time">13:44</a></td></tr>
<tr id="t2019-08-15T13:44:59"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I think it just means the server can't handle enough requests to stop some connections stalling</td><td class="time"><a href="#t2019-08-15T13:44:59" class="time">13:44</a></td></tr>
<tr id="t2019-08-15T13:45:37"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">i.e. the Kernel can't accept anymore connections? Ya that seems likely</td><td class="time"><a href="#t2019-08-15T13:45:37" class="time">13:45</a></td></tr>
<tr id="t2019-08-15T13:46:46"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">1772290 * (0.0011 + 0.0007) = 3190 seconds</td><td class="time"><a href="#t2019-08-15T13:46:46" class="time">13:46</a></td></tr>
<tr id="t2019-08-15T13:46:59"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">Saur: you can monkey patch bitbake. You'd just not *like* to do that</td><td class="time"><a href="#t2019-08-15T13:46:59" class="time">13:46</a></td></tr>
<tr id="t2019-08-15T13:47:35"><th class="nick" style="background: #818144">Saur</th><td class="text" style="color: #818144">No, I definitely don't like the idea of doing that...</td><td class="time"><a href="#t2019-08-15T13:47:35" class="time">13:47</a></td></tr>
<tr id="t2019-08-15T13:48:14"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: So, I think we can say that connections are being serviced in a reasonably timely fashion once if the kernel actually allows them</td><td class="time"><a href="#t2019-08-15T13:48:14" class="time">13:48</a></td></tr>
<tr id="t2019-08-15T13:48:54"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">RP: That was included in the log I posted.</td><td class="time"><a href="#t2019-08-15T13:48:54" class="time">13:48</a></td></tr>
<tr id="t2019-08-15T13:49:09"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">That particular inode was used earlier, but it was still good at the time.</td><td class="time"><a href="#t2019-08-15T13:49:09" class="time">13:49</a></td></tr>
<tr id="t2019-08-15T13:51:04"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I am not exactly sure if it is DB corruption, or some kind of a odd race condition.</td><td class="time"><a href="#t2019-08-15T13:51:04" class="time">13:51</a></td></tr>
<tr id="t2019-08-15T13:51:27"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I suspect I'll have to add additional logging information but I am not sure what to add yet.</td><td class="time"><a href="#t2019-08-15T13:51:27" class="time">13:51</a></td></tr>
<tr id="t2019-08-15T13:52:52"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">This is the first time we have caught it "red handed" so to speak at the first time the bad entry is inputed into the DB.</td><td class="time"><a href="#t2019-08-15T13:52:52" class="time">13:52</a></td></tr>
<tr id="t2019-08-15T13:54:19"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I'd like to be able to create a stand alone test that does that emits the same kind of log entries.</td><td class="time"><a href="#t2019-08-15T13:54:19" class="time">13:54</a></td></tr>
<tr id="t2019-08-15T13:55:35"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">What I don't know is if the client 1/2 of the operation is where things went bad.&nbsp;&nbsp;This is only the server side.&nbsp;&nbsp;I wasn't sure if the client picks up the UID info and just passes it along, or if the server is making some kind of decision.&nbsp;&nbsp;To me it looked like a brand new entry.</td><td class="time"><a href="#t2019-08-15T13:55:35" class="time">13:55</a></td></tr>
<tr id="t2019-08-15T13:57:13"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: this is the challenge with debugging this, its very hard to tell</td><td class="time"><a href="#t2019-08-15T13:57:13" class="time">13:57</a></td></tr>
<tr id="t2019-08-15T13:57:54"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I'll have to go read some more code and such.&nbsp;&nbsp;I have only been working on this intermittently, so I thought I might post what I had.</td><td class="time"><a href="#t2019-08-15T13:57:54" class="time">13:57</a></td></tr>
<tr id="t2019-08-15T13:58:19"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I guess we need to more threads in parallel answering the connections?</td><td class="time"><a href="#t2019-08-15T13:58:19" class="time">13:58</a></td></tr>
<tr id="t2019-08-15T13:58:40"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">What we know now definitively, is that it is a re-used inode and it has something to do with the hard links and mv operations.</td><td class="time"><a href="#t2019-08-15T13:58:40" class="time">13:58</a></td></tr>
<tr id="t2019-08-15T13:58:43"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: its useful, I'm just also unfortunately in the middle of a complex mess with runqueue :(</td><td class="time"><a href="#t2019-08-15T13:58:43" class="time">13:58</a></td></tr>
<tr id="t2019-08-15T13:59:11"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: yes</td><td class="time"><a href="#t2019-08-15T13:59:11" class="time">13:59</a></td></tr>
<tr id="t2019-08-15T13:59:22"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I am in the middle of 2 or 3 other things myself :-)</td><td class="time"><a href="#t2019-08-15T13:59:22" class="time">13:59</a></td></tr>
<tr id="t2019-08-15T13:59:31"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Ya, I think we should make the server use the socketserver.ThreadMixIn class to thread the server, then make the siggen code use a persistent connection</td><td class="time"><a href="#t2019-08-15T13:59:31" class="time">13:59</a></td></tr>
<tr id="t2019-08-15T13:59:51"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: doesn't that code use a thread per connection?</td><td class="time"><a href="#t2019-08-15T13:59:51" class="time">13:59</a></td></tr>
<tr id="t2019-08-15T14:00:16"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I'm not really willing to go that far, bit risky</td><td class="time"><a href="#t2019-08-15T14:00:16" class="time">14:00</a></td></tr>
<tr id="t2019-08-15T14:01:34"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">If you want to share a persistent connection, it makes more sense because then it won't run out of threads to handle new connections (or you need a thread pool that is bounded by the maximum number of clients you expect at any given time)</td><td class="time"><a href="#t2019-08-15T14:01:34" class="time">14:01</a></td></tr>
<tr id="t2019-08-15T14:02:43"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I suspect the current design can handle persistent connections, its the shear number which is overloading it</td><td class="time"><a href="#t2019-08-15T14:02:43" class="time">14:02</a></td></tr>
<tr id="t2019-08-15T14:02:56"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I suspect a thread pool may be easier than persisting though :/</td><td class="time"><a href="#t2019-08-15T14:02:56" class="time">14:02</a></td></tr>
<tr id="t2019-08-15T14:03:14"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Not with one thread.... the single thread will handle only one connection until it closes, so it would block all others</td><td class="time"><a href="#t2019-08-15T14:03:14" class="time">14:03</a></td></tr>
<tr id="t2019-08-15T14:04:48"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: There are easy ways to make the connection persistent, just not with stock python modules.</td><td class="time"><a href="#t2019-08-15T14:04:48" class="time">14:04</a></td></tr>
<tr id="t2019-08-15T14:05:58"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: hmm, I thought the thread worked differently to that :/</td><td class="time"><a href="#t2019-08-15T14:05:58" class="time">14:05</a></td></tr>
<tr id="t2019-08-15T14:06:30"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: let me look, I might be confusing something</td><td class="time"><a href="#t2019-08-15T14:06:30" class="time">14:06</a></td></tr>
<tr id="t2019-08-15T14:08:42"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Rp: OK, I was right. The HTTP handler base class processes request on the connection until it closes: <a href="https://github.com/python/cpython/blob/3.7/Lib/http/server.py#L422" rel="nofollow">https://github.com/python/cpython/blob/3.7/Lib/http/server.py#L422</a></td><td class="time"><a href="#t2019-08-15T14:08:42" class="time">14:08</a></td></tr>
<tr id="t2019-08-15T14:09:26"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">You could, I supposes pass *those* all off to yet another thread, but that seems messy</td><td class="time"><a href="#t2019-08-15T14:09:26" class="time">14:09</a></td></tr>
<tr id="t2019-08-15T14:09:34"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I think we're seeing it differently in that we're thinking about different threads</td><td class="time"><a href="#t2019-08-15T14:09:34" class="time">14:09</a></td></tr>
<tr id="t2019-08-15T14:10:18"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I'm looking at it from the perspective of the sockets being opened by the server. There is a thread dedicated to doing that and queuing them up which isn't blocked on closing</td><td class="time"><a href="#t2019-08-15T14:10:18" class="time">14:10</a></td></tr>
<tr id="t2019-08-15T14:14:27"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Correct... I was running ahead and trying to think about persistent connections and threads. I don't really see how adding more threads would help with non-persistent connections?</td><td class="time"><a href="#t2019-08-15T14:14:27" class="time">14:14</a></td></tr>
<tr id="t2019-08-15T14:15:06"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: it depends where our bottleneck is and I guess on that we're still perhaps not quite in agreement</td><td class="time"><a href="#t2019-08-15T14:15:06" class="time">14:15</a></td></tr>
<tr id="t2019-08-15T14:19:11"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Ok, right. I think (assuming my stat code is correct) that the server handles requests timely once it actually accepts() them. The one metric we don't have is the amount of time a connection is pending in the kernel before userspace calls accept() to get it.</td><td class="time"><a href="#t2019-08-15T14:19:11" class="time">14:19</a></td></tr>
<tr id="t2019-08-15T14:20:09"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">So either 1) The connections are waiting for a long period of time in the listen queue before userspace calls accept() them</td><td class="time"><a href="#t2019-08-15T14:20:09" class="time">14:20</a></td></tr>
<tr id="t2019-08-15T14:20:29"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: think about this maths, We have 40 different autobuilder targets each with 9000 tasks starting in parallel</td><td class="time"><a href="#t2019-08-15T14:20:29" class="time">14:20</a></td></tr>
<tr id="t2019-08-15T14:21:04"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: that means 360,000 requests approximately in parallel which we need to answer in less than two minutes. Can the server do that?</td><td class="time"><a href="#t2019-08-15T14:21:04" class="time">14:21</a></td></tr>
<tr id="t2019-08-15T14:22:56"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: with the average connection time it would take 418s, the average requests time, 248s, both of which are &gt; 120s</td><td class="time"><a href="#t2019-08-15T14:22:56" class="time">14:22</a></td></tr>
<tr id="t2019-08-15T14:23:19"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: so I suspect even the request time is too slow :/</td><td class="time"><a href="#t2019-08-15T14:23:19" class="time">14:23</a></td></tr>
<tr id="t2019-08-15T14:23:44"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">(I'm open to persuasion I'm missing something)</td><td class="time"><a href="#t2019-08-15T14:23:44" class="time">14:23</a></td></tr>
<tr id="t2019-08-15T14:24:38"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: You are correct. I suspect adding one more thread to the pool would cut the request time almost in half... the request time includes the I/O time required to read the data from TCP socket as well as write the results back.</td><td class="time"><a href="#t2019-08-15T14:24:38" class="time">14:24</a></td></tr>
<tr id="t2019-08-15T14:28:06"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: right, we probably ideally want a pool of around 5-10</td><td class="time"><a href="#t2019-08-15T14:28:06" class="time">14:28</a></td></tr>
<tr id="t2019-08-15T14:28:56"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: I think doing that will significantly reduce the request time</td><td class="time"><a href="#t2019-08-15T14:28:56" class="time">14:28</a></td></tr>
<tr id="t2019-08-15T14:30:49"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: But the connect time on it's own is still too long.... I suppose it's possible the reduction in request time would also reduce the connection time</td><td class="time"><a href="#t2019-08-15T14:30:49" class="time">14:30</a></td></tr>
<tr id="t2019-08-15T14:31:55"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Which actually seems pretty likely. The connect time can't *possibly* be shorter (on average) than the request time if the server is running full tilt with a single request handling trhead</td><td class="time"><a href="#t2019-08-15T14:31:55" class="time">14:31</a></td></tr>
<tr id="t2019-08-15T14:40:20"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">either my builds are much bigger or bitbake on one of most powerful servers I've access to is still slower than what people use, will send the parsing times to ML "shortly" last test running on No currently running tasks (28875 of 71749)</td><td class="time"><a href="#t2019-08-15T14:40:20" class="time">14:40</a></td></tr>
<tr id="t2019-08-15T15:35:56"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: or you're hitting the same inotify issue that kanavin's profile seemed to show...</td><td class="time"><a href="#t2019-08-15T15:35:56" class="time">15:35</a></td></tr>
<tr id="t2019-08-15T16:05:05"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: yes, we'll see -P is running now</td><td class="time"><a href="#t2019-08-15T16:05:05" class="time">16:05</a></td></tr>
<tr id="t2019-08-15T16:08:15"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: those "ResourceWarning: unclosed" warnings are about the socket of PRServer on localhost, now I see in some builds that it even started PRServer twice</td><td class="time"><a href="#t2019-08-15T16:08:15" class="time">16:08</a></td></tr>
<tr id="t2019-08-15T16:08:29"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">NOTE: Started PRServer with DBfile: prserv.sqlite3, IP: 127.0.0.1, PORT: 44707, PID: 3947</td><td class="time"><a href="#t2019-08-15T16:08:29" class="time">16:08</a></td></tr>
<tr id="t2019-08-15T16:08:39"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">NOTE: Terminating PRServer...</td><td class="time"><a href="#t2019-08-15T16:08:39" class="time">16:08</a></td></tr>
<tr id="t2019-08-15T16:08:44"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">NOTE: Started PRServer with prserv.sqlite3, IP: 127.0.0.1, PORT: 42189, PID: 3949</td><td class="time"><a href="#t2019-08-15T16:08:44" class="time">16:08</a></td></tr>
<tr id="t2019-08-15T16:08:54"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">bb/codeparser.py:419: ResourceWarning: unclosed &lt;socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('127.0.0.1', 44707)&gt; "while_clause": lambda x: (chain(x.condition, x.cmds), None),</td><td class="time"><a href="#t2019-08-15T16:08:54" class="time">16:08</a></td></tr>
<tr id="t2019-08-15T16:09:36"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">and it's triggered from various places (not just codeparser.py:419)</td><td class="time"><a href="#t2019-08-15T16:09:36" class="time">16:09</a></td></tr>
<tr id="t2019-08-15T16:16:26"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: if I return at "Executing tasks", then it took only 6mins and there is only one notification in the profile (21 config_notification)</td><td class="time"><a href="#t2019-08-15T16:16:26" class="time">16:16</a></td></tr>
<tr id="t2019-08-15T16:18:48"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: so its the iterating through the tasks part that is slow for you?</td><td class="time"><a href="#t2019-08-15T16:18:48" class="time">16:18</a></td></tr>
<tr id="t2019-08-15T16:22:05"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: I think kanavin's numbers were Ctrl+C before exeuting tasks</td><td class="time"><a href="#t2019-08-15T16:22:05" class="time">16:22</a></td></tr>
<tr id="t2019-08-15T16:22:27"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: looks like it, will let it run whole build with -n (with latest master-next it was "only" 90 mins)</td><td class="time"><a href="#t2019-08-15T16:22:27" class="time">16:22</a></td></tr>
<tr id="t2019-08-15T16:22:57"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: that is *way* too long</td><td class="time"><a href="#t2019-08-15T16:22:57" class="time">16:22</a></td></tr>
<tr id="t2019-08-15T16:23:11"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: did you have the -P output for that?</td><td class="time"><a href="#t2019-08-15T16:23:11" class="time">16:23</a></td></tr>
<tr id="t2019-08-15T16:23:40"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">or should I move the return to some better place? I'm looking at the execute() function but don't see where it would make most sense</td><td class="time"><a href="#t2019-08-15T16:23:40" class="time">16:23</a></td></tr>
<tr id="t2019-08-15T16:24:01"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">no, I have -P output only for this short 6min part</td><td class="time"><a href="#t2019-08-15T16:24:01" class="time">16:24</a></td></tr>
<tr id="t2019-08-15T16:27:29"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">90mins is *way* too long, but with older master-next it was over 10 hours, so it's nice improvement :)</td><td class="time"><a href="#t2019-08-15T16:27:29" class="time">16:27</a></td></tr>
<tr id="t2019-08-15T16:27:55"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: Right, its better. What was it before we started messing with runqueue?</td><td class="time"><a href="#t2019-08-15T16:27:55" class="time">16:27</a></td></tr>
<tr id="t2019-08-15T16:28:38"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">before messing with runqueue (bitbake 1f630fdf0260db08541d3ca9f25f852931c19905) it is over 4 hours</td><td class="time"><a href="#t2019-08-15T16:28:38" class="time">16:28</a></td></tr>
<tr id="t2019-08-15T16:29:01"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: so we did actually get better, its still just slow</td><td class="time"><a href="#t2019-08-15T16:29:01" class="time">16:29</a></td></tr>
<tr id="t2019-08-15T16:29:35"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">I can try even older revision, but on small sample (core-image-minimal) this revision was the fast baseline</td><td class="time"><a href="#t2019-08-15T16:29:35" class="time">16:29</a></td></tr>
<tr id="t2019-08-15T16:30:07"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">or something is messing with my benchmark like those PRserver connections</td><td class="time"><a href="#t2019-08-15T16:30:07" class="time">16:30</a></td></tr>
<tr id="t2019-08-15T16:30:12"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">will try to disable PRserv as well</td><td class="time"><a href="#t2019-08-15T16:30:12" class="time">16:30</a></td></tr>
<tr id="t2019-08-15T16:35:06"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: I tried a "bitbake -n world" for poky so effectively oe-core and it takes 2m50</td><td class="time"><a href="#t2019-08-15T16:35:06" class="time">16:35</a></td></tr>
<tr id="t2019-08-15T16:35:36"><th class="nick" style="background: #57a657">dkc</th><td class="text" style="color: #57a657">Hey, i'm trying to implement something similar to that: <a href="https://stackoverflow.com/questions/52729727/how-to-include-git-revision-of-image-layer-in-boot-output-or-etc-issue" rel="nofollow">https://stackoverflow.com/questions/52729727/how-to-include-git-revision-of-image-layer-in-boot-output-or-etc-issue</a></td><td class="time"><a href="#t2019-08-15T16:35:36" class="time">16:35</a></td></tr>
<tr id="t2019-08-15T16:35:37"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: appears to be around 200 tasks/second (12044 in total)</td><td class="time"><a href="#t2019-08-15T16:35:37" class="time">16:35</a></td></tr>
<tr id="t2019-08-15T16:35:46"><th class="nick" style="background: #57a657">dkc</th><td class="text" style="color: #57a657">but the variable with the layer revision seems to never be updated</td><td class="time"><a href="#t2019-08-15T16:35:46" class="time">16:35</a></td></tr>
<tr id="t2019-08-15T16:38:36"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">for me it was about 10 tasks/second, but most of the time was spent between "Executing tasks" message and the next line "Executing task (1 from 71749)"</td><td class="time"><a href="#t2019-08-15T16:38:36" class="time">16:38</a></td></tr>
<tr id="t2019-08-15T16:40:39"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: I should also note that I had BB_NUMBER_THREADS = "8" on this 72threads machine</td><td class="time"><a href="#t2019-08-15T16:40:39" class="time">16:40</a></td></tr>
<tr id="t2019-08-15T16:42:59"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">most of the time it looks like this:</td><td class="time"><a href="#t2019-08-15T16:42:59" class="time">16:42</a></td></tr>
<tr id="t2019-08-15T16:43:02"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">&nbsp;&nbsp;PID USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRI&nbsp;&nbsp;NI&nbsp;&nbsp;VIRT&nbsp;&nbsp; RES&nbsp;&nbsp; SHR S CPU% MEM%&nbsp;&nbsp; TIME+&nbsp;&nbsp;Command</td><td class="time"><a href="#t2019-08-15T16:43:02" class="time">16:43</a></td></tr>
<tr id="t2019-08-15T16:43:02"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">28719 mjansa&nbsp;&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp; 0 1328M 1265M&nbsp;&nbsp;7096 R 100.&nbsp;&nbsp;0.3&nbsp;&nbsp;4:03.05 ├─ python3 /bitbake/bin/bitbake world -P -n</td><td class="time"><a href="#t2019-08-15T16:43:02" class="time">16:43</a></td></tr>
<tr id="t2019-08-15T16:43:06"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">28888 mjansa&nbsp;&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp; 0&nbsp;&nbsp;496M&nbsp;&nbsp;370M&nbsp;&nbsp;8856 S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.1&nbsp;&nbsp;0:01.91 │&nbsp;&nbsp;└─ python3 /bitbake/bin/bitbake-worker decafbadbad</td><td class="time"><a href="#t2019-08-15T16:43:06" class="time">16:43</a></td></tr>
<tr id="t2019-08-15T16:43:09"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">28889 mjansa&nbsp;&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp; 0&nbsp;&nbsp;496M&nbsp;&nbsp;370M&nbsp;&nbsp;8856 S&nbsp;&nbsp;0.0&nbsp;&nbsp;0.1&nbsp;&nbsp;0:00.01 │&nbsp;&nbsp;&nbsp;&nbsp; └─ python3 /bitbake/bin/bitbake-worker decafbadbad</td><td class="time"><a href="#t2019-08-15T16:43:09" class="time">16:43</a></td></tr>
<tr id="t2019-08-15T16:43:12"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">28712 mjansa&nbsp;&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp; 0&nbsp;&nbsp;164M 29380&nbsp;&nbsp;9532 S 40.7&nbsp;&nbsp;0.0&nbsp;&nbsp;0:10.01 │&nbsp;&nbsp;│&nbsp;&nbsp;└─ python3 /bitbake/bin/bitbake world -P -n</td><td class="time"><a href="#t2019-08-15T16:43:12" class="time">16:43</a></td></tr>
<tr id="t2019-08-15T16:43:15"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">28718 mjansa&nbsp;&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp; 0&nbsp;&nbsp;164M 29380&nbsp;&nbsp;9532 R 17.7&nbsp;&nbsp;0.0&nbsp;&nbsp;0:04.14 │&nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp; └─ python3 /bitbake/bin/bitbake world -P -n</td><td class="time"><a href="#t2019-08-15T16:43:15" class="time">16:43</a></td></tr>
<tr id="t2019-08-15T16:44:58"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">and only the first one being busy after "NOTE: Executing Tasks" is shown</td><td class="time"><a href="#t2019-08-15T16:44:58" class="time">16:44</a></td></tr>
<tr id="t2019-08-15T16:45:45"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: that makes sense, the workers get spawned but just return so only the cooker would be loaded</td><td class="time"><a href="#t2019-08-15T16:45:45" class="time">16:45</a></td></tr>
<tr id="t2019-08-15T16:47:22"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">arent workers spawned only when it also shows something like "Executing task (1 from 71749)" ?</td><td class="time"><a href="#t2019-08-15T16:47:22" class="time">16:47</a></td></tr>
<tr id="t2019-08-15T16:48:03"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: yes</td><td class="time"><a href="#t2019-08-15T16:48:03" class="time">16:48</a></td></tr>
<tr id="t2019-08-15T16:48:19"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">I'm not that far, it will take 1-3 hours until I get to that point</td><td class="time"><a href="#t2019-08-15T16:48:19" class="time">16:48</a></td></tr>
<tr id="t2019-08-15T16:48:51"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">Initialising tasks: 100% |###############################################################################################################################################################################################################################| Time: 0:03:20</td><td class="time"><a href="#t2019-08-15T16:48:51" class="time">16:48</a></td></tr>
<tr id="t2019-08-15T16:48:55"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">Sstate summary: Wanted 25260 Found 0 Missed 25260 Current 0 (0% match, 0% complete)</td><td class="time"><a href="#t2019-08-15T16:48:55" class="time">16:48</a></td></tr>
<tr id="t2019-08-15T16:48:58"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">NOTE: Executing Tasks</td><td class="time"><a href="#t2019-08-15T16:48:58" class="time">16:48</a></td></tr>
<tr id="t2019-08-15T16:50:27"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: Setting to 8 threads gave 3m1</td><td class="time"><a href="#t2019-08-15T16:50:27" class="time">16:50</a></td></tr>
<tr id="t2019-08-15T16:51:32"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">interesting, lets see what the profile data will show, but will probably send it tomorrow</td><td class="time"><a href="#t2019-08-15T16:51:32" class="time">16:51</a></td></tr>
<tr id="t2019-08-15T16:52:29"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">this build has also multilib enabled, so it almost doubles the number of available tasks, I should have used something a bit smaller</td><td class="time"><a href="#t2019-08-15T16:52:29" class="time">16:52</a></td></tr>
<tr id="t2019-08-15T17:13:56"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: I'll have to run some more experiments, a build with meta-oe in here is definitely slower :/</td><td class="time"><a href="#t2019-08-15T17:13:56" class="time">17:13</a></td></tr>
<tr id="t2019-08-15T17:15:54"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: 33000 tasks, 22minutes</td><td class="time"><a href="#t2019-08-15T17:15:54" class="time">17:15</a></td></tr>
<tr id="t2019-08-15T17:26:33"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: this is with latest bitbake?</td><td class="time"><a href="#t2019-08-15T17:26:33" class="time">17:26</a></td></tr>
<tr id="t2019-08-15T17:27:55"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: yes</td><td class="time"><a href="#t2019-08-15T17:27:55" class="time">17:27</a></td></tr>
<tr id="t2019-08-15T17:28:29"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: putting it under profiling now but I really need to look at the correctness problems of the last build :/</td><td class="time"><a href="#t2019-08-15T17:28:29" class="time">17:28</a></td></tr>
<tr id="t2019-08-15T17:29:10"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">Looks like we've got some kind of nasty metadata race somewhere :/</td><td class="time"><a href="#t2019-08-15T17:29:10" class="time">17:29</a></td></tr>
<tr id="t2019-08-15T17:31:17"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">will bisect where bitbake started terminating PRserv, it's not one of 2 commits I was suspecting (the cleanup for termination)</td><td class="time"><a href="#t2019-08-15T17:31:17" class="time">17:31</a></td></tr>
<tr id="t2019-08-15T17:31:53"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">looks like this one: 05888700 cooker: Improve hash server startup code to avoid exit tracebacks</td><td class="time"><a href="#t2019-08-15T17:31:53" class="time">17:31</a></td></tr>
<tr id="t2019-08-15T17:33:34"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">this issue is reproducible with 'PRSERV_HOST = "localhost:0"' in local.conf</td><td class="time"><a href="#t2019-08-15T17:33:34" class="time">17:33</a></td></tr>
<tr id="t2019-08-15T17:34:24"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">but probably not related to the delay I'm seeing, because for last run with -P I've disabled PRserv and rm_work as well and it's still sitting between "Executing tasks" and executing them</td><td class="time"><a href="#t2019-08-15T17:34:24" class="time">17:34</a></td></tr>
<tr id="t2019-08-15T17:39:05"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: if I remove self.handlePRServ() added to reset() it works again</td><td class="time"><a href="#t2019-08-15T17:39:05" class="time">17:39</a></td></tr>
<tr id="t2019-08-15T17:40:51"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: right, that would account for the socket issue but probably not the delays</td><td class="time"><a href="#t2019-08-15T17:40:51" class="time">17:40</a></td></tr>
<tr id="t2019-08-15T18:03:05"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Added more stats logging and multiple threads to the hash server: <a href="http://git.yoctoproject.org/cgit.cgi/poky-contrib/commit/?h=jpew/hashserve-stats&amp;id=66c70708515cdeb903a93bd738b8f6a87cdd3926" rel="nofollow">http://git.yoctoproject.org/cgit.cgi/poky-contrib/commit/?h=jpew/hashserve-stats&amp;id=66c70708515cdeb903a93bd738b8f6a87cdd3926</a></td><td class="time"><a href="#t2019-08-15T18:03:05" class="time">18:03</a></td></tr>
<tr id="t2019-08-15T18:07:38"><th class="nick" style="background: #57a657">dkc</th><td class="text" style="color: #57a657">do you have tips on how I could include the git revision of our custom layer in the yocto image? I have a hacky solution with a "nostamp" task, but as a consequence it forces the generation of the rootfs even if nothing changed, I'd like to avoid that</td><td class="time"><a href="#t2019-08-15T18:07:38" class="time">18:07</a></td></tr>
<tr id="t2019-08-15T18:15:59"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">dkc: check ./meta/classes/image-buildinfo.bbclass</td><td class="time"><a href="#t2019-08-15T18:15:59" class="time">18:15</a></td></tr>
<tr id="t2019-08-15T18:20:41"><th class="nick" style="background: #57a657">dkc</th><td class="text" style="color: #57a657">JaMa: looks like exactly like what I need, thanks</td><td class="time"><a href="#t2019-08-15T18:20:41" class="time">18:20</a></td></tr>
<tr id="t2019-08-15T18:31:15"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">is it expected that core-image-minimal depends on things like libx11 now? It seems to be caused by systemd -&gt; dbus -&gt; libx11: "dbus.do_package" -&gt; "libx11.do_packagedata"</td><td class="time"><a href="#t2019-08-15T18:31:15" class="time">18:31</a></td></tr>
<tr id="t2019-08-15T18:39:43"><th class="nick" style="background: #5959a9">mischief</th><td class="text" style="color: #5959a9">it seems if i use fitimage and also INITRAMFS_IMAGE_BUNDLE my kernel has the initramfs twice. is there a way to prevent that?</td><td class="time"><a href="#t2019-08-15T18:39:43" class="time">18:39</a></td></tr>
<tr id="t2019-08-15T18:40:41"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">RP: I got another hit with more logs and things line up to a lack of understanding how this could happen.</td><td class="time"><a href="#t2019-08-15T18:40:41" class="time">18:40</a></td></tr>
<tr id="t2019-08-15T18:40:51"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I am not so sure that pseudo is the problem either.</td><td class="time"><a href="#t2019-08-15T18:40:51" class="time">18:40</a></td></tr>
<tr id="t2019-08-15T18:41:10"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">If we assume that pseudo is not doing the inode assignment.</td><td class="time"><a href="#t2019-08-15T18:41:10" class="time">18:41</a></td></tr>
<tr id="t2019-08-15T18:41:27"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It is asked to instantiate a hard link, but there is no "origination" location.</td><td class="time"><a href="#t2019-08-15T18:41:27" class="time">18:41</a></td></tr>
<tr id="t2019-08-15T18:42:01"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">Example:</td><td class="time"><a href="#t2019-08-15T18:42:01" class="time">18:42</a></td></tr>
<tr id="t2019-08-15T18:42:07"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">(exact 1 d /L/2.28-r0/locale-tree/usr/lib64/locale/ar_JO.ISO-8859-6/LC_NUMERIC) (exact 1 duf /L/2.28-r0/locale-tree/usr/lib64/locale/ar_JO.ISO-8859-6/LC_NUMERIC)</td><td class="time"><a href="#t2019-08-15T18:42:07" class="time">18:42</a></td></tr>
<tr id="t2019-08-15T18:42:07"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">(new?) new link: path /L/2.28-r0/locale-tree/usr/lib64/locale/ar_DZ.ISO-8859-6/LC_NUMERIC.tmp, ino 190901401, mode 0100644</td><td class="time"><a href="#t2019-08-15T18:42:07" class="time">18:42</a></td></tr>
<tr id="t2019-08-15T18:42:07"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">No origin inode data: 190901401 [ no path ]</td><td class="time"><a href="#t2019-08-15T18:42:07" class="time">18:42</a></td></tr>
<tr id="t2019-08-15T18:43:14"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I went and poked the actual dir structure, and sure enough.&nbsp;&nbsp;That is the only instance of that inode.&nbsp;&nbsp;It should have been linked off to other locations with the LC_NUMERIC, since they are all the same file.</td><td class="time"><a href="#t2019-08-15T18:43:14" class="time">18:43</a></td></tr>
<tr id="t2019-08-15T18:43:35"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I don't really understand how that can happen though.</td><td class="time"><a href="#t2019-08-15T18:43:35" class="time">18:43</a></td></tr>
<tr id="t2019-08-15T18:44:14"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: How can you hardlink to something which doesn't have an inode you're linking to?</td><td class="time"><a href="#t2019-08-15T18:44:14" class="time">18:44</a></td></tr>
<tr id="t2019-08-15T18:44:43"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I have no idea.&nbsp;&nbsp;That is why I put a new log line in there, to prove it was hitting this condition.</td><td class="time"><a href="#t2019-08-15T18:44:43" class="time">18:44</a></td></tr>
<tr id="t2019-08-15T18:45:26"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I need to trace back to the requestor, since down at the pseudo DB level / server level that information is long gone.</td><td class="time"><a href="#t2019-08-15T18:45:26" class="time">18:45</a></td></tr>
<tr id="t2019-08-15T18:45:47"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">Some how this file was turned into a copy instead of a link.</td><td class="time"><a href="#t2019-08-15T18:45:47" class="time">18:45</a></td></tr>
<tr id="t2019-08-15T18:45:55"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: It at least gives a clue on what we're looking for...</td><td class="time"><a href="#t2019-08-15T18:45:55" class="time">18:45</a></td></tr>
<tr id="t2019-08-15T18:46:25"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">All the failures (I have 3 so far), have the exact same signature.</td><td class="time"><a href="#t2019-08-15T18:46:25" class="time">18:46</a></td></tr>
<tr id="t2019-08-15T18:47:44"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I thought about putting in clean up code in pseudo to "fix it up" but it clearly isn't the right way to deal with this.</td><td class="time"><a href="#t2019-08-15T18:47:44" class="time">18:47</a></td></tr>
<tr id="t2019-08-15T18:47:55"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">We have a garbage in, garbage out situation.</td><td class="time"><a href="#t2019-08-15T18:47:55" class="time">18:47</a></td></tr>
<tr id="t2019-08-15T18:48:30"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I just don't understand where the garbage came from.&nbsp;&nbsp;Clearly it is an error which should probably be fatal if you are asked to hard link something for which there is no reference.</td><td class="time"><a href="#t2019-08-15T18:48:30" class="time">18:48</a></td></tr>
<tr id="t2019-08-15T18:48:33"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: right, I think we need to understand it more...</td><td class="time"><a href="#t2019-08-15T18:48:33" class="time">18:48</a></td></tr>
<tr id="t2019-08-15T18:48:40"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I don't get how it becomes a copy though.</td><td class="time"><a href="#t2019-08-15T18:48:40" class="time">18:48</a></td></tr>
<tr id="t2019-08-15T18:49:12"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">that is odd...</td><td class="time"><a href="#t2019-08-15T18:49:12" class="time">18:49</a></td></tr>
<tr id="t2019-08-15T18:49:32"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">Just thought I'd provide an update or if you or anyone else has insights, I am open to any input.</td><td class="time"><a href="#t2019-08-15T18:49:32" class="time">18:49</a></td></tr>
<tr id="t2019-08-15T18:50:07"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I appreciate the update but I'm not close enough to the code to have useful input :(</td><td class="time"><a href="#t2019-08-15T18:50:07" class="time">18:50</a></td></tr>
<tr id="t2019-08-15T18:50:42"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I do agree its odd though as how would a hardlink become a copy. Maybe a libc call fails and this is the fallback?</td><td class="time"><a href="#t2019-08-15T18:50:42" class="time">18:50</a></td></tr>
<tr id="t2019-08-15T18:51:20"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I was chatting with marka earlier.&nbsp;&nbsp;He mentioned there is glibc.bbclass or something which deals with some of this.</td><td class="time"><a href="#t2019-08-15T18:51:20" class="time">18:51</a></td></tr>
<tr id="t2019-08-15T18:51:35"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It is specific to how the locales are copied.</td><td class="time"><a href="#t2019-08-15T18:51:35" class="time">18:51</a></td></tr>
<tr id="t2019-08-15T18:51:40"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I'll look there next.</td><td class="time"><a href="#t2019-08-15T18:51:40" class="time">18:51</a></td></tr>
<tr id="t2019-08-15T18:52:29"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I am not sure how to track down the caller yet, but we do know that by the time pseudo (the server side) is asked to process the hard link, it is already trashed.</td><td class="time"><a href="#t2019-08-15T18:52:29" class="time">18:52</a></td></tr>
<tr id="t2019-08-15T18:52:41"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: yes, if its being copied in our code then it will try a hardlink, if it fails it will resort to a copy</td><td class="time"><a href="#t2019-08-15T18:52:41" class="time">18:52</a></td></tr>
<tr id="t2019-08-15T18:52:43"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It is still possible the pseudo client end is broken in some way.</td><td class="time"><a href="#t2019-08-15T18:52:43" class="time">18:52</a></td></tr>
<tr id="t2019-08-15T18:53:16"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: we have a the copy fall back for cases spanning different disks or similar</td><td class="time"><a href="#t2019-08-15T18:53:16" class="time">18:53</a></td></tr>
<tr id="t2019-08-15T18:55:06"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: Its glibc-locale.inc and libc-package.bbclass</td><td class="time"><a href="#t2019-08-15T18:55:06" class="time">18:55</a></td></tr>
<tr id="t2019-08-15T18:55:40"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I'll have to figure out what to instrument, but I'll start with old fashion code inspection first.</td><td class="time"><a href="#t2019-08-15T18:55:40" class="time">18:55</a></td></tr>
<tr id="t2019-08-15T18:55:56"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I'd like to see what lines with what prints out in the logs.</td><td class="time"><a href="#t2019-08-15T18:55:56" class="time">18:55</a></td></tr>
<tr id="t2019-08-15T19:05:27"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">hmm... I seem to have stumbled on what happened, but it will take a while to figure out what to instrument next.</td><td class="time"><a href="#t2019-08-15T19:05:27" class="time">19:05</a></td></tr>
<tr id="t2019-08-15T19:05:29"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b"><a href="https://pastebin.com/DwnTENVU" rel="nofollow">https://pastebin.com/DwnTENVU</a></td><td class="time"><a href="#t2019-08-15T19:05:29" class="time">19:05</a></td></tr>
<tr id="t2019-08-15T19:05:52"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">The evidence show the original file was created and reference was purged.</td><td class="time"><a href="#t2019-08-15T19:05:52" class="time">19:05</a></td></tr>
<tr id="t2019-08-15T19:05:58"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">so it became a copy.</td><td class="time"><a href="#t2019-08-15T19:05:58" class="time">19:05</a></td></tr>
<tr id="t2019-08-15T19:12:06"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I wonder if some kind of atomic op guarantee on a libc call was broken by pseudo?</td><td class="time"><a href="#t2019-08-15T19:12:06" class="time">19:12</a></td></tr>
<tr id="t2019-08-15T19:12:52"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">Good question.&nbsp;&nbsp;I am inspecting through the pseudo code first, then I need to try and find the caller.</td><td class="time"><a href="#t2019-08-15T19:12:52" class="time">19:12</a></td></tr>
<tr id="t2019-08-15T19:13:03"><th class="nick" style="background: #adad5b">fray</th><td class="text" style="color: #adad5b">calls used to be blocking until recently.. but that isn't the issue cause this stuff was broken before that change..</td><td class="time"><a href="#t2019-08-15T19:13:03" class="time">19:13</a></td></tr>
<tr id="t2019-08-15T19:16:17"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">&nbsp;&nbsp; case OP_MAY_UNLINK:</td><td class="time"><a href="#t2019-08-15T19:16:17" class="time">19:16</a></td></tr>
<tr id="t2019-08-15T19:16:17"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (pdb_may_unlink_file(msg, msg-&gt;client)) {</td><td class="time"><a href="#t2019-08-15T19:16:17" class="time">19:16</a></td></tr>
<tr id="t2019-08-15T19:16:18"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* harmless, but client wants to know so it knows</td><td class="time"><a href="#t2019-08-15T19:16:18" class="time">19:16</a></td></tr>
<tr id="t2019-08-15T19:16:18"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * whether to follow up... */</td><td class="time"><a href="#t2019-08-15T19:16:18" class="time">19:16</a></td></tr>
<tr id="t2019-08-15T19:16:18"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg-&gt;result = RESULT_FAIL;</td><td class="time"><a href="#t2019-08-15T19:16:18" class="time">19:16</a></td></tr>
<tr id="t2019-08-15T19:16:18"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="time"><a href="#t2019-08-15T19:16:18" class="time">19:16</a></td></tr>
<tr id="t2019-08-15T19:16:43"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I am not so sure we do the right thing...&nbsp;&nbsp;Or a badly written app might not do the right thing.</td><td class="time"><a href="#t2019-08-15T19:16:43" class="time">19:16</a></td></tr>
<tr id="t2019-08-15T19:17:22"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">More instrumentation is required to find out exactly where we go off the rails.</td><td class="time"><a href="#t2019-08-15T19:17:22" class="time">19:17</a></td></tr>
<tr id="t2019-08-15T19:51:42"><th class="nick" style="background: #b15db1">vpaladino778</th><td class="text" style="color: #b15db1">Hey folks. I was given a Poky SDK Installer. I ran it and tried running the 'environment-setup-armv5e-poky-linux-gnueabi' file that it created, but nothing seems to be happening</td><td class="time"><a href="#t2019-08-15T19:51:42" class="time">19:51</a></td></tr>
<tr id="t2019-08-15T19:53:30"><th class="nick" style="background: #4b904b">Crofton|work</th><td class="text" style="color: #4b904b">that just sets some environment variables</td><td class="time"><a href="#t2019-08-15T19:53:30" class="time">19:53</a></td></tr>
<tr id="t2019-08-15T19:54:53"><th class="nick" style="background: #b15db1">vpaladino778</th><td class="text" style="color: #b15db1">Do you know how i would compile a program using the Poky SDK that i installed?</td><td class="time"><a href="#t2019-08-15T19:54:53" class="time">19:54</a></td></tr>
<tr id="t2019-08-15T19:57:02"><th class="nick" style="background: #adad5b">fray</th><td class="text" style="color: #adad5b">once you source it.. call 'make' or autoconf or....</td><td class="time"><a href="#t2019-08-15T19:57:02" class="time">19:57</a></td></tr>
<tr id="t2019-08-15T19:57:16"><th class="nick" style="background: #adad5b">fray</th><td class="text" style="color: #adad5b">if you just want to compile a single file, $CC -o output input.c</td><td class="time"><a href="#t2019-08-15T19:57:16" class="time">19:57</a></td></tr>
<tr id="t2019-08-15T19:57:28"><th class="nick" style="background: #adad5b">fray</th><td class="text" style="color: #adad5b">no magic involved.. standard environment variables are set</td><td class="time"><a href="#t2019-08-15T19:57:28" class="time">19:57</a></td></tr>
<tr id="t2019-08-15T20:03:39"><th class="nick" style="background: #b15db1">vpaladino778</th><td class="text" style="color: #b15db1">So after running 'environment-setup' i can just compile as i normally would and it will compile to the targets platform?</td><td class="time"><a href="#t2019-08-15T20:03:39" class="time">20:03</a></td></tr>
<tr id="t2019-08-15T20:04:07"><th class="nick" style="background: #adad5b">fray</th><td class="text" style="color: #adad5b">that is the idea.. just be sure you use the environment variables and not direct calls to 'gcc'</td><td class="time"><a href="#t2019-08-15T20:04:07" class="time">20:04</a></td></tr>
<tr id="t2019-08-15T20:07:27"><th class="nick" style="background: #b15db1">vpaladino778</th><td class="text" style="color: #b15db1">Ahah. I understand. Thank you for your help.</td><td class="time"><a href="#t2019-08-15T20:07:27" class="time">20:07</a></td></tr>
<tr id="t2019-08-15T20:08:46"><th class="nick" style="background: #b15db1">vpaladino778</th><td class="text" style="color: #b15db1">One last question. How can i make sure that i 'use the ennironment variables'? Do i just have to make sure i run the 'environment-setup' file in the current shell session?</td><td class="time"><a href="#t2019-08-15T20:08:46" class="time">20:08</a></td></tr>
<tr id="t2019-08-15T20:09:41"><th class="nick" style="background: #b15db1">vpaladino778</th><td class="text" style="color: #b15db1">Sorry for me naivety. I'm a new-grad and this is all pretty new to me</td><td class="time"><a href="#t2019-08-15T20:09:41" class="time">20:09</a></td></tr>
<tr id="t2019-08-15T20:09:47"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">vpaladino778: Make sure your build system (make, autotools, meson, cmake, whatever) uses them</td><td class="time"><a href="#t2019-08-15T20:09:47" class="time">20:09</a></td></tr>
<tr id="t2019-08-15T20:10:43"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Including using them yourself if you are your own build system, e.g.: `$CC -o hello -c hello.c`</td><td class="time"><a href="#t2019-08-15T20:10:43" class="time">20:10</a></td></tr>
<tr id="t2019-08-15T20:49:45"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: Going to try that patch, thanks!</td><td class="time"><a href="#t2019-08-15T20:49:45" class="time">20:49</a></td></tr>
<tr id="t2019-08-15T21:05:15"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">jwessel: have you seen this? <a href="http://git.openembedded.org/openembedded-core-contrib/tree/meta/recipes-devtools/pseudo/pseudo-test.bb?h=jansa/pseudo2" rel="nofollow">http://git.openembedded.org/openembedded-core-contrib/tree/meta/recipes-devtools/pseudo/pseudo-test.bb?h=jansa/pseudo2</a> it's definitelly badly written app and breaks pseudo every single time (maybe with different root cause though)</td><td class="time"><a href="#t2019-08-15T21:05:15" class="time">21:05</a></td></tr>
<tr id="t2019-08-15T21:05:57"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I had not seen that one.</td><td class="time"><a href="#t2019-08-15T21:05:57" class="time">21:05</a></td></tr>
<tr id="t2019-08-15T21:06:32"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">more details in <a href="https://bugzilla.yoctoproject.org/show_bug.cgi?id=12434#c48" rel="nofollow">https://bugzilla.yoctoproject.org/show_bug.cgi?id=12434#c48</a></td><td class="time"><a href="#t2019-08-15T21:06:32" class="time">21:06</a></td></tr>
<tr id="t2019-08-15T21:06:32"><th class="nick" style="background: #488888">yocti</th><td class="text" style="color: #488888">Bug 12434: normal, Medium+, 2.8 M3, randy.macleod, ACCEPTED , pseudo: Incorrect UID/GID in packaged files</td><td class="time"><a href="#t2019-08-15T21:06:32" class="time">21:06</a></td></tr>
<tr id="t2019-08-15T21:10:03"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: To continue that conversation from earlier, I just dreamt the idea of task specific hosttools using symlinks</td><td class="time"><a href="#t2019-08-15T21:10:03" class="time">21:10</a></td></tr>
<tr id="t2019-08-15T21:10:30"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">Its so crazy we have to do it...</td><td class="time"><a href="#t2019-08-15T21:10:30" class="time">21:10</a></td></tr>
<tr id="t2019-08-15T21:10:45"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">JaMa: It doesn't seem at first glance that is the same problem.</td><td class="time"><a href="#t2019-08-15T21:10:45" class="time">21:10</a></td></tr>
<tr id="t2019-08-15T21:11:02"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: would solve the task rss contamination problem in theory to a large extent</td><td class="time"><a href="#t2019-08-15T21:11:02" class="time">21:11</a></td></tr>
<tr id="t2019-08-15T21:24:33"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: we've had far too many rays of hope with this bug where we think we may have found it, then not....</td><td class="time"><a href="#t2019-08-15T21:24:33" class="time">21:24</a></td></tr>
<tr id="t2019-08-15T21:24:53"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I don't doubt that.&nbsp;&nbsp;This is fairly complex.</td><td class="time"><a href="#t2019-08-15T21:24:53" class="time">21:24</a></td></tr>
<tr id="t2019-08-15T21:25:39"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I see something happening consistently with each build, even in the ones that don't actually fail.</td><td class="time"><a href="#t2019-08-15T21:25:39" class="time">21:25</a></td></tr>
<tr id="t2019-08-15T21:26:12"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I've suspected/hoped for that. Question is why some fail and some don't</td><td class="time"><a href="#t2019-08-15T21:26:12" class="time">21:26</a></td></tr>
<tr id="t2019-08-15T21:26:34"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: if we could make it 100% failing we'd no doubt quickly figure it out :)</td><td class="time"><a href="#t2019-08-15T21:26:34" class="time">21:26</a></td></tr>
<tr id="t2019-08-15T21:26:34"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">That answer is pretty easy, from the logs.</td><td class="time"><a href="#t2019-08-15T21:26:34" class="time">21:26</a></td></tr>
<tr id="t2019-08-15T21:26:54"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">If I add some sleep into pseudo, it will probably fail every time, but I am not sure.</td><td class="time"><a href="#t2019-08-15T21:26:54" class="time">21:26</a></td></tr>
<tr id="t2019-08-15T21:27:31"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">The logs indicate it is picking up the underlying (what ever was used last) for the inode in the case of the hard link that was turned to a file.</td><td class="time"><a href="#t2019-08-15T21:27:31" class="time">21:27</a></td></tr>
<tr id="t2019-08-15T21:27:59"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It happens a few times in every single build, but the ones that pass are the ones where has selected UID 0.</td><td class="time"><a href="#t2019-08-15T21:27:59" class="time">21:27</a></td></tr>
<tr id="t2019-08-15T21:28:23"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It really should be 100% impossible for the hard link to have no source reference.</td><td class="time"><a href="#t2019-08-15T21:28:23" class="time">21:28</a></td></tr>
<tr id="t2019-08-15T21:28:59"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">That is why I put a print log there.&nbsp;&nbsp;I figured it shouldn't be hitting that line of code _ever_</td><td class="time"><a href="#t2019-08-15T21:28:59" class="time">21:28</a></td></tr>
<tr id="t2019-08-15T21:29:10"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">interesting part for me was that it's consistent when restoring "bad" do_package archive from sstate (so once you create and store bad archive it will always fail as long as you're using the same sstate signature)</td><td class="time"><a href="#t2019-08-15T21:29:10" class="time">21:29</a></td></tr>
<tr id="t2019-08-15T21:29:19"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I haven't been able to make a shell script which makes it act the same.</td><td class="time"><a href="#t2019-08-15T21:29:19" class="time">21:29</a></td></tr>
<tr id="t2019-08-15T21:29:21"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: so my inode reuse theory is actually right!</td><td class="time"><a href="#t2019-08-15T21:29:21" class="time">21:29</a></td></tr>
<tr id="t2019-08-15T21:29:47"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">Well technically it appears to be the pseudo cache.</td><td class="time"><a href="#t2019-08-15T21:29:47" class="time">21:29</a></td></tr>
<tr id="t2019-08-15T21:30:08"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">The problem is a bit hard to track because each instance involves 3 inodes.</td><td class="time"><a href="#t2019-08-15T21:30:08" class="time">21:30</a></td></tr>
<tr id="t2019-08-15T21:30:31"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: Right, that was what I'd theorised though - that some file known to pseudo was deleted and then a new file was created using the same inode so the permissions/user were copied</td><td class="time"><a href="#t2019-08-15T21:30:31" class="time">21:30</a></td></tr>
<tr id="t2019-08-15T21:31:01"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">and that pseudo writtes a lot of warnings and errors in each build even the ones which ended probably OK :)</td><td class="time"><a href="#t2019-08-15T21:31:01" class="time">21:31</a></td></tr>
<tr id="t2019-08-15T21:31:08"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: it kind of implies we're missing deletion tracking with pseudo which is possible as we remove files out of pseudo context</td><td class="time"><a href="#t2019-08-15T21:31:08" class="time">21:31</a></td></tr>
<tr id="t2019-08-15T21:31:27"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">Is there any way that is happening?</td><td class="time"><a href="#t2019-08-15T21:31:27" class="time">21:31</a></td></tr>
<tr id="t2019-08-15T21:31:34"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I wish we could do path filtering in pseudo :/</td><td class="time"><a href="#t2019-08-15T21:31:34" class="time">21:31</a></td></tr>
<tr id="t2019-08-15T21:31:47"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: absolutely certain its happening</td><td class="time"><a href="#t2019-08-15T21:31:47" class="time">21:31</a></td></tr>
<tr id="t2019-08-15T21:31:52"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It looked to me like the delete was actually there, and it more like there is something happening in parallel.</td><td class="time"><a href="#t2019-08-15T21:31:52" class="time">21:31</a></td></tr>
<tr id="t2019-08-15T21:32:10"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: it was only a theory but I know we do delete files out of context</td><td class="time"><a href="#t2019-08-15T21:32:10" class="time">21:32</a></td></tr>
<tr id="t2019-08-15T21:32:35"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">(why would we load pseudo and do deletion under it?)</td><td class="time"><a href="#t2019-08-15T21:32:35" class="time">21:32</a></td></tr>
<tr id="t2019-08-15T21:32:55"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">As long as you are sane about it, it should be ok.</td><td class="time"><a href="#t2019-08-15T21:32:55" class="time">21:32</a></td></tr>
<tr id="t2019-08-15T21:33:16"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: what could be interesting would be doing a sanity check of pseudo's db against the disk periodically</td><td class="time"><a href="#t2019-08-15T21:33:16" class="time">21:33</a></td></tr>
<tr id="t2019-08-15T21:33:20"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I can say with certainty I know how to re-use the inodes.</td><td class="time"><a href="#t2019-08-15T21:33:20" class="time">21:33</a></td></tr>
<tr id="t2019-08-15T21:33:53"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">On a quiet disk I can allocate and re-allocate any which way I want.</td><td class="time"><a href="#t2019-08-15T21:33:53" class="time">21:33</a></td></tr>
<tr id="t2019-08-15T21:34:05"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I never figured that out :)</td><td class="time"><a href="#t2019-08-15T21:34:05" class="time">21:34</a></td></tr>
<tr id="t2019-08-15T21:34:25"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">But I am trying to limit it down to something reproducible.</td><td class="time"><a href="#t2019-08-15T21:34:25" class="time">21:34</a></td></tr>
<tr id="t2019-08-15T21:34:42"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: right, that is what we need</td><td class="time"><a href="#t2019-08-15T21:34:42" class="time">21:34</a></td></tr>
<tr id="t2019-08-15T21:34:59"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I can't see at the moment how to get it to the state where the ln proceeds without the whole "load my system and hope it happens..."</td><td class="time"><a href="#t2019-08-15T21:34:59" class="time">21:34</a></td></tr>
<tr id="t2019-08-15T21:35:30"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">At this point I do see the bad state with every single run of the do_package.</td><td class="time"><a href="#t2019-08-15T21:35:30" class="time">21:35</a></td></tr>
<tr id="t2019-08-15T21:36:42"><td class="action" colspan="2">* jwessel has a few more tests cases to try and duplicate it, before the day over for now.</td><td><a href="#t2019-08-15T21:36:42" class="time">21:36</a></td></tr>
<tr id="t2019-08-15T21:41:37"><td class="action" colspan="2">* RP is hoping jwessel can figure it out :)</td><td><a href="#t2019-08-15T21:41:37" class="time">21:41</a></td></tr>
<tr id="t2019-08-15T21:41:50"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">This might take days.</td><td class="time"><a href="#t2019-08-15T21:41:50" class="time">21:41</a></td></tr>
<tr id="t2019-08-15T21:42:34"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">As with all problems like this, finding the root cause doesn't mean it will be easy to fix.</td><td class="time"><a href="#t2019-08-15T21:42:34" class="time">21:42</a></td></tr>
<tr id="t2019-08-15T21:43:33"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: new server swaps build warnings for failures: <a href="https://autobuilder.yoctoproject.org/typhoon/#/builders/15/builds/1171" rel="nofollow">https://autobuilder.yoctoproject.org/typhoon/#/builders/15/builds/1171</a></td><td class="time"><a href="#t2019-08-15T21:43:33" class="time">21:43</a></td></tr>
<tr id="t2019-08-15T21:44:11"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: I know. I'm dealing with&nbsp;&nbsp;a similar multiheaded monster in the form of runqueue too :/</td><td class="time"><a href="#t2019-08-15T21:44:11" class="time">21:44</a></td></tr>
<tr id="t2019-08-15T21:46:03"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: {"connections": {"total_time": 130.6708268285729, "max_time": 0.027425227221101522, "num": 485853, "average": 0.0002689513635370635, "stdev": 0.0002935243837515032}, "requests": {"total_time": 824.3801162638701, "max_time": 0.43299578316509724, "num": 485848, "average": 0.0016967860653205739, "stdev": 0.0015868506651319188}}</td><td class="time"><a href="#t2019-08-15T21:46:03" class="time">21:46</a></td></tr>
<tr id="t2019-08-15T21:47:26"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: hmm... did you remove the io and sql&nbsp;&nbsp;stats?</td><td class="time"><a href="#t2019-08-15T21:47:26" class="time">21:47</a></td></tr>
<tr id="t2019-08-15T21:47:38"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: no?</td><td class="time"><a href="#t2019-08-15T21:47:38" class="time">21:47</a></td></tr>
<tr id="t2019-08-15T21:48:30"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: oh, I think I've missed a commit</td><td class="time"><a href="#t2019-08-15T21:48:30" class="time">21:48</a></td></tr>
<tr id="t2019-08-15T21:48:49"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Ah.... I'm actually impressed that applies cleanly :)</td><td class="time"><a href="#t2019-08-15T21:48:49" class="time">21:48</a></td></tr>
<tr id="t2019-08-15T21:49:13"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: yes, so am I looking at it!</td><td class="time"><a href="#t2019-08-15T21:49:13" class="time">21:49</a></td></tr>
<tr id="t2019-08-15T21:49:31"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Git is a mysterious entity</td><td class="time"><a href="#t2019-08-15T21:49:31" class="time">21:49</a></td></tr>
<tr id="t2019-08-15T21:49:34"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: would that cause the connection reset issue?</td><td class="time"><a href="#t2019-08-15T21:49:34" class="time">21:49</a></td></tr>
<tr id="t2019-08-15T21:50:05"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Possibly?</td><td class="time"><a href="#t2019-08-15T21:50:05" class="time">21:50</a></td></tr>
<tr id="t2019-08-15T21:50:26"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">I have been running bitbake-selftest hashserv.tests on my changes</td><td class="time"><a href="#t2019-08-15T21:50:26" class="time">21:50</a></td></tr>
<tr id="t2019-08-15T21:51:14"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">If the server was getting a python exception in the thread I think that would cause a connection reset</td><td class="time"><a href="#t2019-08-15T21:51:14" class="time">21:51</a></td></tr>
<tr id="t2019-08-15T21:52:15"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: that was what I was just thinking looking at the missing import</td><td class="time"><a href="#t2019-08-15T21:52:15" class="time">21:52</a></td></tr>
<tr id="t2019-08-15T21:53:37"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: time bitbake world -P -n is still running after over 5 hours not yet executing tasks (on older bitbake) so it might be even slower than 253min run done earlier today on the same build</td><td class="time"><a href="#t2019-08-15T21:53:37" class="time">21:53</a></td></tr>
<tr id="t2019-08-15T21:57:33"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: That is just crazy :(</td><td class="time"><a href="#t2019-08-15T21:57:33" class="time">21:57</a></td></tr>
<tr id="t2019-08-15T21:57:57"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: I need to figure out what is wrong. I think my more limited world build should give me the baseline profile data I need...</td><td class="time"><a href="#t2019-08-15T21:57:57" class="time">21:57</a></td></tr>
<tr id="t2019-08-15T21:58:25"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I've sorted out the patches and restarted everything, lets try again</td><td class="time"><a href="#t2019-08-15T21:58:25" class="time">21:58</a></td></tr>
<tr id="t2019-08-15T21:58:32"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">Cool</td><td class="time"><a href="#t2019-08-15T21:58:32" class="time">21:58</a></td></tr>
<tr id="t2019-08-15T21:58:55"><td class="action" colspan="2">* RP knows he's going to run out of time on this soon :(</td><td><a href="#t2019-08-15T21:58:55" class="time">21:58</a></td></tr>
<tr id="t2019-08-15T22:06:33"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: <a href="https://autobuilder.yoctoproject.org/typhoon/#/builders/48/builds/938" rel="nofollow">https://autobuilder.yoctoproject.org/typhoon/#/builders/48/builds/938</a> :(</td><td class="time"><a href="#t2019-08-15T22:06:33" class="time">22:06</a></td></tr>
<tr id="t2019-08-15T22:08:45"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: Argh.... OK.</td><td class="time"><a href="#t2019-08-15T22:08:45" class="time">22:08</a></td></tr>
<tr id="t2019-08-15T22:09:08"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">I'll try and keep the logging but revert back to the previous threading</td><td class="time"><a href="#t2019-08-15T22:09:08" class="time">22:09</a></td></tr>
<tr id="t2019-08-15T22:09:17"><th class="nick" style="background: #539e9e">JPEW</th><td class="text" style="color: #539e9e">RP: OK. I have to go home, but I'll give it a think.</td><td class="time"><a href="#t2019-08-15T22:09:17" class="time">22:09</a></td></tr>
<tr id="t2019-08-15T22:09:42"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: thanks, this was a good try :)</td><td class="time"><a href="#t2019-08-15T22:09:42" class="time">22:09</a></td></tr>
<tr id="t2019-08-15T22:10:37"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: I'm just reverting so I can test the other changes in -next which are a mix of normal patches and runqueue fixes</td><td class="time"><a href="#t2019-08-15T22:10:37" class="time">22:10</a></td></tr>
<tr id="t2019-08-15T22:20:50"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">So, in a non-failed build I absolutely have the same problem each time, as I mentioned before.</td><td class="time"><a href="#t2019-08-15T22:20:50" class="time">22:20</a></td></tr>
<tr id="t2019-08-15T22:21:09"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I see how it happens, but still don't know the root cause.</td><td class="time"><a href="#t2019-08-15T22:21:09" class="time">22:21</a></td></tr>
<tr id="t2019-08-15T22:22:50"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">There are is pile of these requests coming in, parallel.&nbsp;&nbsp; And the mv bit is not atomic.</td><td class="time"><a href="#t2019-08-15T22:22:50" class="time">22:22</a></td></tr>
<tr id="t2019-08-15T22:23:14"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">The unlink occurs before the rename</td><td class="time"><a href="#t2019-08-15T22:23:14" class="time">22:23</a></td></tr>
<tr id="t2019-08-15T22:23:36"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I haven't determined that the problem is actually the fault of pseudo or not.</td><td class="time"><a href="#t2019-08-15T22:23:36" class="time">22:23</a></td></tr>
<tr id="t2019-08-15T22:23:56"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I don't understand how all these db requests are coming in, in parallel.</td><td class="time"><a href="#t2019-08-15T22:23:56" class="time">22:23</a></td></tr>
<tr id="t2019-08-15T22:25:23"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">BTW, if we were to add a QA check against the files we know are supposed to all be hard linked together.&nbsp;&nbsp;It would fail 100% of the time.</td><td class="time"><a href="#t2019-08-15T22:25:23" class="time">22:25</a></td></tr>
<tr id="t2019-08-15T22:25:39"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">We get a couple strays that became hard copies each time.</td><td class="time"><a href="#t2019-08-15T22:25:39" class="time">22:25</a></td></tr>
<tr id="t2019-08-15T22:26:05"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: That sounds like a good way to debug this if we have a sentinel we can spot....</td><td class="time"><a href="#t2019-08-15T22:26:05" class="time">22:26</a></td></tr>
<tr id="t2019-08-15T22:26:26"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">By luck of the draw most of the time it has not failed due to the QA check being for the builder UID.</td><td class="time"><a href="#t2019-08-15T22:26:26" class="time">22:26</a></td></tr>
<tr id="t2019-08-15T22:26:48"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: most files we delete would be owned by "root", not the build user</td><td class="time"><a href="#t2019-08-15T22:26:48" class="time">22:26</a></td></tr>
<tr id="t2019-08-15T22:26:53"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">It is going to be a different file every time, but the investigation thus far shows 100% failure rate.</td><td class="time"><a href="#t2019-08-15T22:26:53" class="time">22:26</a></td></tr>
<tr id="t2019-08-15T22:27:11"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">right statistically we process enough files something breaks</td><td class="time"><a href="#t2019-08-15T22:27:11" class="time">22:27</a></td></tr>
<tr id="t2019-08-15T22:27:36"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">I really need to have a hard look at the operations.</td><td class="time"><a href="#t2019-08-15T22:27:36" class="time">22:27</a></td></tr>
<tr id="t2019-08-15T22:27:46"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">But that is it for now.</td><td class="time"><a href="#t2019-08-15T22:27:46" class="time">22:27</a></td></tr>
<tr id="t2019-08-15T22:27:51"><th class="nick" style="background: #9b519b">jwessel</th><td class="text" style="color: #9b519b">For today anyway.</td><td class="time"><a href="#t2019-08-15T22:27:51" class="time">22:27</a></td></tr>
<tr id="t2019-08-15T22:28:08"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">jwessel: its great progress as I can think of ways of debugging this further from there! :)</td><td class="time"><a href="#t2019-08-15T22:28:08" class="time">22:28</a></td></tr>
<tr id="t2019-08-15T22:42:17"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">kanavin, JaMa: the notifications are about the generation of task specific profiles</td><td class="time"><a href="#t2019-08-15T22:42:17" class="time">22:42</a></td></tr>
<tr id="t2019-08-15T22:46:25"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JPEW: managed another connection reset without the threading patch :(</td><td class="time"><a href="#t2019-08-15T22:46:25" class="time">22:46</a></td></tr>
<tr id="t2019-08-15T22:46:55"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">definitely not as common</td><td class="time"><a href="#t2019-08-15T22:46:55" class="time">22:46</a></td></tr>
<tr id="t2019-08-15T22:54:57"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">RP: I'm getting close with that profile, not on task 50K from 62K</td><td class="time"><a href="#t2019-08-15T22:54:57" class="time">22:54</a></td></tr>
<tr id="t2019-08-15T22:56:52"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">now when some tasks are "running" there is some load on the worker process as well</td><td class="time"><a href="#t2019-08-15T22:56:52" class="time">22:56</a></td></tr>
<tr id="t2019-08-15T22:57:19"><th class="nick" style="background: #42427e">RP</th><td class="text" style="color: #42427e">JaMa: that makes sense since I guess its instructed to fork()</td><td class="time"><a href="#t2019-08-15T22:57:19" class="time">22:57</a></td></tr>
<tr id="t2019-08-15T23:10:26"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">heh, it finished.. *a lot* of profile* files in this directory :), will upload in a sec</td><td class="time"><a href="#t2019-08-15T23:10:26" class="time">23:10</a></td></tr>
<tr id="t2019-08-15T23:16:18"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555"><a href="http://paste.ubuntu.com/p/Nw6n5hTPmF/" rel="nofollow">http://paste.ubuntu.com/p/Nw6n5hTPmF/</a> <a href="http://paste.ubuntu.com/p/sydFGvYTxQ/" rel="nofollow">http://paste.ubuntu.com/p/sydFGvYTxQ/</a> <a href="http://paste.ubuntu.com/p/RMGbm9DyZz/" rel="nofollow">http://paste.ubuntu.com/p/RMGbm9DyZz/</a></td><td class="time"><a href="#t2019-08-15T23:16:18" class="time">23:16</a></td></tr>
<tr id="t2019-08-15T23:17:00"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">the first is the "short 5 min" build til "Executing Tasks", then the profile.log.processed and last is from profile-worker.log.processed</td><td class="time"><a href="#t2019-08-15T23:17:00" class="time">23:17</a></td></tr>
<tr id="t2019-08-15T23:17:21"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">all 3 with bitbake 1f630fdf0260db08541d3ca9f25f852931c19905 (before most runqueue changes)</td><td class="time"><a href="#t2019-08-15T23:17:21" class="time">23:17</a></td></tr>
<tr id="t2019-08-15T23:35:15"><th class="nick" style="background: #a25555">JaMa</th><td class="text" style="color: #a25555">maybe the logger.debug in scenequeue_updatecounters()?</td><td class="time"><a href="#t2019-08-15T23:35:15" class="time">23:35</a></td></tr>
</table>
<div class="navigation"> <a href="%23yocto.2019-08-14.log.html">&#171; Wednesday, 2019-08-14</a> <a href="index.html">Index</a> <a href="%23yocto.2019-08-16.log.html">Friday, 2019-08-16 &#187;</a> </div>

<div class="generatedby">
<p>Generated by irclog2html.py 2.11.0 by <a href="mailto:marius@pov.lt">Marius Gedminas</a>
 - find it at <a href="http://mg.pov.lt/irclog2html/">mg.pov.lt</a>!</p>
</div>
</body>
</html>
